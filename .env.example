# =============================================================================
# DGIST Agentic AI Platform - 환경변수 설정
# =============================================================================
# [운영 배포 시 반드시 변경] 표시된 항목은 운영서버에서 반드시 새 값으로 교체해야 합니다.
# [운영 배포 시 변경] 표시된 항목은 운영 환경에 맞게 변경해야 합니다.
# [운영 배포 시 권장] 표시된 항목은 보안 강화를 위해 변경을 권장합니다.
#
# 이 파일을 .env.local로 복사하여 실제 값을 채워넣으세요.
# =============================================================================

# -----------------------------------------------------------------------------
# 도메인 및 보안
# -----------------------------------------------------------------------------
# [운영 배포 시 변경] 서비스 기본 URL (임베드 코드 생성 등에 사용)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# [운영 배포 시 권장] 임베드 허용 origin (쉼표 구분, 비어있으면 모든 origin 허용)
# NEXT_PUBLIC_ALLOWED_EMBED_ORIGINS=https://portal.dgist.ac.kr,https://intranet.dgist.ac.kr

# -----------------------------------------------------------------------------
# 관리자 보안
# -----------------------------------------------------------------------------
# 관리자 URL 경로 (기본값: admin → /admin/login, 예: dgai-mgmt → /dgai-mgmt/login)
NEXT_PUBLIC_ADMIN_BASE_PATH=admin

# [운영 배포 시 권장] 관리자 IP 화이트리스트 (CIDR 지원, 쉼표 구분, 비어있으면 모든 IP 허용)
# 운영 예: ADMIN_ALLOWED_IPS=10.110.2.0/24,203.0.113.5
ADMIN_ALLOWED_IPS=

# -----------------------------------------------------------------------------
# 데이터베이스
# -----------------------------------------------------------------------------
# [운영 배포 시 변경] PostgreSQL 접속 정보 (호스트, 비밀번호 변경 필수)
# Docker Compose로 실행: docker-compose -f docker-compose.dev.yml up -d
DATABASE_URL=postgresql://chatbot:chatbot123@localhost:5432/chatbot

# -----------------------------------------------------------------------------
# JWT (RS256) - 레거시 인증 시스템 연동
# -----------------------------------------------------------------------------
# [운영 배포 시 반드시 변경] 새 키 쌍 생성: npm run generate-keys
# 또는 수동 생성:
#   openssl genrsa -out private.pem 2048
#   openssl rsa -in private.pem -pubout -out public.pem
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"
JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"

# 레거시 서버와 일치해야 함
JWT_ISSUER=dgist-auth
JWT_AUDIENCE=dgist-chatbot

# -----------------------------------------------------------------------------
# API Key 암호화 (AES-256-GCM)
# -----------------------------------------------------------------------------
# [운영 배포 시 반드시 변경] 새 키 생성: openssl rand -base64 32
ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# 인증 모드
# -----------------------------------------------------------------------------
# [운영 배포 시 변경] 'legacy' 필수 (운영에서 mock 사용 불가)
# 'mock': 개발용 Mock 인증
# 'legacy': 프로덕션용 레거시 인증 API 연동
AUTH_MODE=mock

# [운영 배포 시 변경] 실제 레거시 인증 API URL
LEGACY_AUTH_API_URL=https://portal.dgist.ac.kr/api/auth/login

# -----------------------------------------------------------------------------
# 레거시 인증 연동
# -----------------------------------------------------------------------------
# JWT + 쿠키 통일 만료 시간 (기본값: 8시간)
JWT_EXPIRY_HOURS=8

# [운영 배포 시 반드시 변경] embed-token API 인증 키 (새 키 생성: openssl rand -base64 32)
EMBED_API_KEY=

# [운영 배포 시 반드시 변경] HMAC 서명 공유 비밀키 (새 키 생성: openssl rand -base64 32, 레거시 서버와 동일 값 공유)
EMBED_HMAC_SECRET=

# [운영 배포 시 변경] 레거시 사용자 확인 API URL
LEGACY_VERIFY_API_URL=
