# ============================================
# DGIST Agentic AI Platform - 환경 변수 설정
# ============================================

# ============================================
# 데이터베이스 (PostgreSQL 15)
# ============================================
# Docker Compose로 실행: docker-compose -f docker-compose.dev.yml up -d
DATABASE_URL=postgresql://chatbot:chatbot123@localhost:5432/chatbot

# ============================================
# JWT 인증 (RS256 키페어)
# ============================================
# 개인키 생성: openssl genrsa -out private.pem 2048
# 공개키 추출: openssl rsa -in private.pem -pubout -out public.pem
# 환경변수용 변환 (줄바꿈을 \n으로):
#   cat private.pem | sed ':a;N;$!ba;s/\n/\\n/g'
#   cat public.pem | sed ':a;N;$!ba;s/\n/\\n/g'

JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"
JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
JWT_ISSUER=dgist-auth
JWT_AUDIENCE=dgist-chatbot

# ============================================
# API Key 암호화 (AES-256-GCM)
# ============================================
# 32바이트 랜덤 키 생성: openssl rand -base64 32
# ⚠️ 프로덕션에서는 반드시 새로운 키 생성 필요
ENCRYPTION_KEY=

# ============================================
# 인증 모드 설정
# ============================================
# 'mock': 개발용 Mock 인증 (admin/admin123, user/user123)
# 'legacy': 프로덕션용 레거시 인증 API 연동
AUTH_MODE=mock

# 레거시 인증 API URL (AUTH_MODE=legacy일 때 사용)
LEGACY_AUTH_API_URL=https://portal.dgist.ac.kr/api/auth/login

# ============================================
# (선택) 레거시 단일 앱 설정
# ============================================
# Phase 7 이후 제거 가능 (하위 호환용)
# Dify App ID (앱 URL의 xxx 부분: https://cloud.dify.ai/app/xxx/workflow)
NEXT_PUBLIC_APP_ID=

# Dify API Key (앱의 "API Access" 페이지에서 생성)
NEXT_PUBLIC_APP_KEY=

# Dify API URL (클라우드: https://api.dify.ai/v1, 자체 호스팅: 커스텀 URL)
NEXT_PUBLIC_API_URL=https://api.dify.ai/v1

# ============================================
# Phase 7: 익명 사용자 설정 (선택)
# ============================================
# IP당 최대 익명 세션 수 (미설정 시 무제한)
# MAX_ANONYMOUS_SESSIONS_PER_IP=10

# 익명 세션 타임아웃 (초 단위, 미설정 시 무제한)
# ANONYMOUS_SESSION_TIMEOUT=86400
